# 第10章　表单输入绑定

对于Vue来说，使用v-bind并不能解决表单域对象双向绑定的需求。所谓双向绑定，就是无论是通过input还是通过Vue对象，都能修改绑定的数据对象的值。Vue提供了v-model进行双向绑定。本章将重点讲解表单域对象的双向绑定方法和技巧。

## 10.1　实现双向数据绑定

对于数据的绑定，不管是使用插值表达式（{{}}）还是v-text指令，对于数据间的交互都是单向的，只能将Vue实例里的值传递给页面，页面对数据值的任何操作却无法传递给model。

MVVM模式最重要的一个特性，可以说是数据的双向绑定，而Vue作为一个MVVM框架，肯定也实现了数据的双向绑定。在Vue中使用内置的v-model指令完成数据在View与Model间的双向绑定。

可以用v-model指令在表单<input>、<textarea>及<select>元素上创建双向数据绑定。它会根据控件类型自动选取正确的方法来更新元素。尽管有些神奇，但v-model本质上不过是语法糖。它负责监听用户的输入事件以更新数据，并对一些极端场景进行一些特殊处理。

v-model会忽略所有表单元素的value、checked、selected特性的初始值，而总是将Vue实例的数据作为数据来源。这里应该通过JavaScript在组件的data选项中声明初始值。

## 10.2　单行文本输入框

下面讲解最常见的单行文本输入框的数据双向绑定。【例10.1】绑定单行文本输入框（源代码\ch10\10.1.html）。[插图]在浏览器中运行程序，效果如图10-1所示；在输入框中输入“白玉盘中看却无”，可以看到下面的内容也发生了变化，如图10-2所示。[插图]



图10-1　页面初始化效果[插图]图10-2　变更后效果

## 10.3　多行文本输入框

本节演示在多行文本输入框textarea标签中绑定message属性。

【例10.2】绑定多行文本输入框（源代码\ch10\10.2.html）。

[插图]

在浏览器中运行程序，效果如图10-3所示；在textarea标签中输入多行文本，效果如图10-4所示。[插图]





图10-3　页面初始化效果[插图]图10-4　绑定多行文本输入框

## 10.4　复选框

复选框单独使用时，绑定的是布尔值，选中则值为true，未选中则值为false。示例代码如下。【例10.3】绑定单个复选框（源代码\ch10\10.3.html）。[插图]在浏览器中运行程序，效果如图10-5所示；当选中复选框后，checked的值变为true，效果如图10-6所示。[插图]



图10-5　页面初始化效果[插图]图10-6　选中效果多个复选框绑定到同一个数组，被选中的添加到数组中。示例代码如下。【例10.4】绑定多个复选框（源代码\ch10\10.4.html）。[插图]在浏览器中运行程序，选择多个复选框，选择的内容显示在数组中，如图10-7所示。



图10-7　绑定多个复选框

## 10.5　单选按钮

单选按钮一般都有多个条件可供选择，既然是单选按钮，自然希望实现互斥效果，这个效果可以使用v-model指令配合单选框的value来实现。在【例10.5】中，多个单选框绑定到同一个数组，被选中的添加到数组中。【例10.5】绑定单选按钮（源代码\ch10\10.5.html）。[插图]在浏览器中运行程序，单击“D”单选按钮，效果如图10-8所示。[插图]



图10-8　绑定单选按钮

## 10.6　选择框

本节将详细讲述如何绑定单选框、多选框和用v-for渲染的动态选项。1．单选框不需要为<select>标签添加任何属性，即可实现单选。示例如下。【例10.6】绑定单选框（源代码\ch10\10.6.html）。[插图]在浏览器中运行程序，在下拉选项中选择“Java开发班”，选择结果中也变成了“Java开发班”，效果如图10-9所示。[插图]图10-9　绑定单选框提示如果v-model表达式的初始值未能匹配任何选项，<select>元素将被渲染为“未选中”状态。2．多选框（绑定到一个数组）为<select>标签添加multiple属性，即可实现多选。示例如下。



【例10.7】绑定多选框（源代码\ch10\10.7.html）。[插图]在浏览器中运行程序，按住Ctrl键可以选择多个选项，效果如图10-10所示。[插图]图10-10　绑定多选框3．用v-for渲染的动态选项在实际应用场景中，<select>标签中的<option>一般是通过v-for指令动态输出的，其中每一项的value或text都可以使用v-bind动态输出。【例10.8】用v-for渲染的动态选项（源代码\ch10\10.8.html）。[插图]



在浏览器中运行程序，然后在选择框中选择“课程2”，将会显示它对应的value值，效果如图10-11所示。[插图]图10-11　v-for渲染的动态选项

## 10.7　值绑定

对于单选按钮、复选框及选择框的选项，v-model绑定的值通常是静态字符串（对于复选框也可以是布尔值）。但是，有时可能想把值绑定到Vue实例的一个动态属性上，这种情况可以用v-bind实现，并且这个属性的值可以不是字符串。10.7.1　复选框在下面示例中，true-value和false-value特性并不会影响输入控件的value特性，因为浏览器在提交表单时并不会包含未被选中的复选框。如果要确保表单中这两个值中的一个能够被提交，比如“yes”或“no”，请换用单选按钮。【例10.9】动态绑定复选框（源代码\ch10\10.9.html）。[插图]在浏览器中运行程序，默认状态效果如图10-12所示；选择复选框的状态效果如图10-13所示。



10-13所示。[插图]图10-12　选中效果[插图]图10-13　选择复选框的状态10.7.2　单选框首先为单选按钮绑定一个属性date，定义属性值为“洗衣机”；然后使用v-model指令为单选按钮绑定pick属性，当单选按钮选中后，pick的值等于a的属性值。【例10.10】动态绑定单选框的值（源代码\ch10\10.10.html）。[插图]在浏览器中运行程序，如图10-14所示；选中“洗衣机”单选按钮，将显示其value值，效果如图10-15所示。[插图]



图10-14　单选框未选中效果[插图]图10-15　单选框选中效果10.7.3　选择框的选项在下面示例中，定义了4个option选项，并使用v-bind进行绑定。【例10.11】动态绑定选择框的选项（源代码\ch10\10.11.html）。[插图]在浏览器中运行程序，选中“C”和“D”选项，在p标签中将显示相应的number值，如图10-16所示。[插图]



图10-16　动态绑定选择框的选项

## 10.8　修饰符

对于v-model指令，还有3个常用的修饰符：lazy、number和trim。下面分别进行介绍。

10.8.1　lazy在输入框中，v-model默认是同步数据，使用lazy会转变为在change事件中同步，也就是在失去焦点或者按下回车键时才更新。

【例10.12】lazy修饰符（源代码\ch10\10.12.html）。

[插图]

在浏览器中运行程序，输入“回看天际下中流”，如图10-17所示；失去焦点或者按下回车键后同步数据，结果如图10-18所示。

[插图]

图10-17　输入数据

[插图]

图10-18　失去焦点后同步数据

10.8.2　numbernumber修饰符可以将输入的值转化为Number类型，否则虽然输入的是数字，但它的类型其实是String。number修饰符在数字输入框中比较有用。如果想自动将用户的输入值转为数值类型，可以给v-model添加number修饰符。这通常很有用，因为即使在type="number"时，HTML输入元素的值也总会返回字符串。如果这个值无法被parseFloat()解析，则会返回原始的值。

【例10.13】number修饰符（源代码\ch10\10.13.html）。

[插图]

在浏览器中运行程序，输入“1680”，由于使用了number修饰符，所以显示的数据类型为number类型，如图10-19所示。[插图]图10-19　number修饰符10.8.3　trim



如果要自动过滤用户输入的首尾空格，可以给v-model添加trim修饰符。示例如下所示。【例10.14】trim修饰符（源代码\ch10\10.14.html）。[插图]在浏览器中运行程序，在输入框中输入“apple18.6”，其前后设置许多空格，可以看到val的长度为9，不会因为添加空格而改变val，效果如图10-20所示。[插图]图10-20　trim修饰符

## 10.9　综合案例——设计用户注册页面

使用Vue设计用户注册页面比较简单。通过使用v-model指令对表单数据自动收集，从而能轻松实现表单输入和应用状态之间的双向绑定。

【例10.15】设计用户注册页面（源代码\ch10\10.15.html）。

```html
```





在浏览器中运行程序，输入注册的信息后单击“注册”按钮，按F12键打开控制台并切换到“Console”选项，可以看到用户的注册信息，如图10-21所示。

[插图]

图10-21　设计用户注册页面

## 10.10　疑难解惑

疑问1：Vue中标签怎么绑定事件？

Vue中利用v-model进行表单数据的双向绑定，具体做了两个操作：

（1）v-bind绑定了一个value的属性。

（2）利用v-on把当前的元素绑定到一个事件上。例如下面的代码：

[插图]

在浏览器中运行，效果如图10-22所示。





图10-22　数据的双向绑定input元素本身有个oninput事件，这是HTML5新增加的，类似onchange，每当输入框内容发生变化时，就会触发oninput，把最新的value传递给inputValue。

疑问2：如何使用v-model指令在表单上实现数据的双向绑定？

表单元素可以与用户进行交互，所以使用v-model指令在表单控件或者组件上创建双向绑定。v-model其实是相当于把Vue中的属性绑定到元素（input）上，如果该数据属性有值，则值会显示到input中，同时元素中输入的内容也决定Vue中的属性值。v-model在内部为不同的输入元素提供不同的属性并抛出不同的事件：

（1）text和textarea元素使用value属性和input事件。

（2）checkbox和radio使用checked属性和change事件。

（3）select字段将value作为prop并将change作为事件。







